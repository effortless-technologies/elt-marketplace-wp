<?php

class WCMp_Product_Import_Export_Bundle_Frontend {

    public function __construct() {
        //enqueue scripts
        add_action('wp_enqueue_scripts', array(&$this, 'frontend_scripts'));
        //enqueue styles
        add_action('wp_enqueue_scripts', array(&$this, 'frontend_styles'));

        add_action('wcmp_product_import_export_bundle_frontend_hook', array(&$this, 'wcmp_product_import_export_bundle_frontend_function'), 10, 2);

        $is_import_export_show = get_option('wcmp_import_export_settings_name');
        if (isset($is_import_export_show['can_add_bulk_products'])) {
            add_action('after_product_manager', array($this, 'add_import_export_menu_dashboard'), 20, 2);
            add_filter('wcmp_vendor_submit_product', array($this, 'remove_direct_link'), 40);
        }
    }

    function remove_direct_link($url) {
        if (!class_exists('WCMp_Frontend_Product_Manager')) {
            return '#';
        } else {
            return $url;
        }
    }

    function add_import_export_menu_dashboard($vendor, $selected_item) {
        global $WCMp_Product_Import_Export_Bundle, $WCMp;
        $pages = get_option('wcmp_pages_settings_name');
        if (class_exists('WCMp_Frontend_Product_Manager')) {
            ?>
            <ul id="wcmp_import_export_product" style="display:none;">
                <li ><a  target="_blank" href="<?php echo isset($pages['vendor_upload_product']) ? get_permalink($pages['vendor_upload_product']) : ''; ?>"><?php _e('- Upload', $WCMp->text_domain); ?></a></li>
            </ul>
            <script type="text/javascript" >
                jQuery(document).ready(function ($) {
                    var upload_link = $("#wcmp_import_export_product");
                    var html_to_be_inserted = upload_link.html();
                    var myproduct_ele = $("a[data-menu_item='product_manager']");
                    var ulelement = myproduct_ele.parent();
                    var element_placed_in = ulelement.find('ul.submenu');
                    element_placed_in.append(html_to_be_inserted);
                    upload_link.remove();

                });
            </script>
            <?php
        } else {
            ?>
            <ul class="submenu" style="display:none;">
                <li><a   target="_blank" href="<?php echo admin_url('edit.php?post_type=product'); ?>"><?php _e('- Add Product', $WCMp->text_domain); ?></a></li>
                <li><a   target="_blank" href="<?php echo isset($pages['vendor_upload_product']) ? get_permalink($pages['vendor_upload_product']) : ''; ?>"><?php _e('- Upload', $WCMp->text_domain); ?></a></li>
            </ul>			
            <?php
        }
    }

    function frontend_scripts() {
        global $WCMp_Product_Import_Export_Bundle;
        $frontend_script_path = $WCMp_Product_Import_Export_Bundle->plugin_url . 'assets/frontend/js/';
        $frontend_script_path = str_replace(array('http:', 'https:'), '', $frontend_script_path);
        $pluginURL = str_replace(array('http:', 'https:'), '', $WCMp_Product_Import_Export_Bundle->plugin_url);
        $suffix = defined('SCRIPT_DEBUG') && SCRIPT_DEBUG ? '' : '.min';

        // Enqueue your frontend javascript from here
    }

    function frontend_styles() {
        global $WCMp_Product_Import_Export_Bundle;
        $frontend_style_path = $WCMp_Product_Import_Export_Bundle->plugin_url . 'assets/frontend/css/';
        $frontend_style_path = str_replace(array('http:', 'https:'), '', $frontend_style_path);
        $suffix = defined('SCRIPT_DEBUG') && SCRIPT_DEBUG ? '' : '.min';

        // Enqueue your frontend stylesheet from here
    }

    function wcmp_wcmp_product_import_export_bundle_frontend_function() {
        // Do your frontend work here
    }

}
